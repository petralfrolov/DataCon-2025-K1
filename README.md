# DataCon‑2025 — команда **K1**

Ниже приведён итоговый README, описывающий весь пайплайн «end‑to‑end» для хакатона DataCon‑25 (TЗ → [https://github.com/AsyaOrlova/DataCon25](https://github.com/AsyaOrlova/DataCon25)).
Файл **DataCon.ipynb** содержит весь исполняемый код, а **DataCon.pptx** — краткие слайды‑выжимку.

---

## Содержание

1. [Выбор мишеней](#выбор-мишеней-для-разработки-лигандов)
2. [Импорт и подготовка данных](#импорт-и-подготовка-данных)
3. [Обучение моделей](#обучение-моделей-для-предсказания-активности)
4. [Генерация / отбор молекул](#генерация-и-отбор-молекул)
5. [Докинг и пост‑анализ](#докинг-лучшей-молекулы)
6. [Ссылки и литература](#ссылки-и-литература)

---

## Выбор мишеней для разработки лигандов

| №     | Гипотеза                                                        | Ключевая идея                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Мишень                                                                                  |
| ----- | --------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------- |
| **1** | **Амилоидная (amyloid-cascade)**                                | Первичным событием считается чрезмерное образование/слабый клиренс Аβ-пептида, что запускает каскад нейротоксических процессов; недавнее одобрение моноклональных антител (адуканамаб, леканемаб) подтвердило клиническую валидность гипотезы. ([PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC10796101/ "\n            Alzheimer's Disease Puzzle: Delving into Pathogenesis Hypotheses - PMC\n        "))                                                                                                                                                                                  | **BACE1** (β-секретаза 1) — лимитирующий протеолитический фермент образования Aβ        |
| **2** | **Тау-гиперфосфорилирование/пропагация**                        | Агрегация гиперфосфорилированного тау теснее коррелирует с когнитивным спадом, чем количество бета-амилоида; активно тестируются анти-тау-антитела и ингибиторы тау-киназ. ([PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC10796101/ "\n            Alzheimer's Disease Puzzle: Delving into Pathogenesis Hypotheses - PMC\n        "))                                                                                                                                                                                                                                                      | **GSK-3β** — ключевая киназа фосфорилирования тау                                       |
| **3** | **Нейровоспалительная (микроглиальная)**                        | Геномные исследования  указывают, что хроническая активация микроглии и высвобождение провоспалительных медиаторов ускоряют нейродегенерацию; мишени — рецепторы врождённого иммунитета и инфламмасомы. ([PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC11259573/ "\n            The neuroinflammatory role of microglia in Alzheimer's disease and their associated therapeutic targets - PMC\n        "))                                                                                                                                                                                  | **TREM2** — микроглиальный рецептор, регулирующий фагоцитоз и фенотип DAM               |
| **4** | **Нейроваскулярная/нарушенного BBB-клиренса**                   | Утечка гематоэнцефалического барьера и снижение выноса Aβ через LRP1, рост транспорта через RAGE ведут к отложению амилоида и гипоксии; сосудистые факторы риска увеличивают вероятность БА. ([Nature](https://www.nature.com/articles/s41392-024-01911-3 "Recent advances in Alzheimer’s disease: mechanisms, clinical trials and new drug development strategies | Signal Transduction and Targeted Therapy"))                                                                                                                                                                             | **LRP1** — эндотелиальный транспортер, выносящий Aβ из мозга                            |
| **5** | **Метаболическая («тип 3 диабета», резистентность к инсулину)** | Нарушение сигнальных путей инсулина/IGF-1 в мозге ведёт к гиперфосфорилированию тау, усилению амилоидогенеза и энергетическому дефициту; GLP-1-агонисты и сенситайзеры тестируются в клинике. ([Nature](https://www.nature.com/articles/s41392-024-01911-3 "Recent advances in Alzheimer’s disease: mechanisms, clinical trials and new drug development strategies | Signal Transduction and Targeted Therapy"), [PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC11593477/ "\n            Alzheimer’s Disease as Type 3 Diabetes: Understanding the Link and Implications - PMC\n        ")) | **IRS-1** — центральный адаптер инсулинового сигнала, гиперсерин-фосфорилируется при БА |
| **6** | **Митохондриально-окислительная (mitochondrial cascade)**       | Ранние дефекты митохондрий, ROS-стресс и сбой митофагии запускают энергодефицит и апоптоз нейронов; концептуально объединена в «MNM-гипотезу» (mitochondrial-neurovascular-metabolic). ([PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC10796101/ "\n            Alzheimer's Disease Puzzle: Delving into Pathogenesis Hypotheses - PMC\n        "), [PubMed](https://pubmed.ncbi.nlm.nih.gov/39519272/?utm_source=chatgpt.com "From Plaques to Pathways in Alzheimer's Disease - PubMed"))                                                                                                   | **PINK1/Parkin** — регуляторы очистки повреждённых митохондрий                          |
| **7** | **Холинергическая/синаптическая**                               | Дегенерация базальных холинергических нейронов приводит к дефициту ацетилхолина и ранним когнитивным симптомам; терапия ингибиторами холинэстераз остаётся стандартом, но носит лишь симптоматический характер. ([PMC](https://pmc.ncbi.nlm.nih.gov/articles/PMC11354293/ "\n            Advances in Cholinesterase Inhibitor Research—An Overview of Preclinical Studies of Selected Organoruthenium(II) Complexes - PMC\n        "))                                                                                                                                                       | **AChE** — ацетилхолинэстераза, классическая мишень донепезила, ривастигмина и др.      |
| **8** | **Металлической дисгомеостаз (Cu/Fe/Zn)**                       | Накопление ионов меди, железа, цинка в уязвимых областях мозга катализирует образование ROS, усиливает агрегацию Aβ/тау и провоцирует ферроптоз; разрабатываются хелаторы ионы-селективные. ([PubMed](https://pubmed.ncbi.nlm.nih.gov/36455485/ "The metal ion hypothesis of Alzheimer's disease and the anti-neuroinflammatory effect of metal chelators - PubMed"))                                                                                                                                                                                                                        | **Cu²⁺-связывающий мотив Aβ** — объект металлохелирующих соединений                     |

На 2024 год было активно 164 испытания 127 препаратов, из которых 120 - однотаргетные и 7 мультитаргетные.

Причины:

1. **Регуляторно-маркетинговый фактор**
   *Успешные односторонние примеры* (лейканемаб, донанемаб) быстро получили ускоренное или полное одобрение FDA благодаря наличию валидированных биомаркеров (пет-скан Aβ, CSF-pTau) и ясного механизма действия. [U.S. Food and Drug Administration](https://www.fda.gov/news-events/press-announcements/fda-grants-accelerated-approval-alzheimers-disease-treatment?utm_source=chatgpt.com)
   Компании инвестируют туда, где путь к регистрации наиболее предсказуем.
2. **Фармакокинетика и безопасность**
   Слить два фармакофора в одну молекулу — увеличить молекулярную массу, снизить проницаемость ГЭБ и усложнить метаболизм, что влечёт провалы MTDL-кандидатов на токсикологии или первой фазе.
3. **Все равно растущее академическое давление**
   Библиометрия показывает, что публикации по MTDL за последние 10 лет росли быстрее, чем по любым отдельным гипотезам, что подталкивает индустрию искать «умен-компромиссы» — либо *гибриды* с MW < 550 Da, либо фиксированные комбинации (пример: ксаномелин + троспиум в фазе III). [dementiaresearcher.nihr.ac.uk](https://www.dementiaresearcher.nihr.ac.uk/2025-alzheimers-drug-pipeline-shows-growth-and-diversity/)

Поэтому нам разработки в области мульти-мишеней кажутся более перспектывными.

В итоге мы выбрали:

| Мишень                 | Почему выбрана                                                                                            | Объём открытых данных | Структуры PDB |
| ---------------------- | --------------------------------------------------------------------------------------------------------- | --------------------- | ------------- |
| **BACE1** (CHEMBL4822) | Лимитирующий шаг амилоидного каскада (β‑секретаза 1). Огромный набор ингибиторов → хороший сигнал для ML. | ≈ 22 000 Ki/IC₅₀      | Доступны      |
| **AChE** (CHEMBL220)   | Классическая симптоматическая мишень БА; даёт вторую «независимую» активность для концепции MTDL.         | ≈ 14 000 Ki/IC₅₀      | Доступны      |

> Стратегия — **multi‑target**: одновременно увеличить когнитивный эффект (AChE) и модифицировать патологию (BACE1).

---

## Импорт и подготовка данных

### 1. Выгрузки

| Источник      | AChE                                                                                                                                  | BACE1                                                                                                                                 |
| ------------- | ------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------- |
| **ChEMBL**    | [https://www.ebi.ac.uk/chembl/explore/target/CHEMBL220](https://www.ebi.ac.uk/chembl/explore/target/CHEMBL220)                        | [https://www.ebi.ac.uk/chembl/explore/target/CHEMBL4822](https://www.ebi.ac.uk/chembl/explore/target/CHEMBL4822)                      |
| **BindingDB** | [https://www.bindingdb.org/rwd/tmp/petralfrolov\_gmail.com4902.tsv](https://www.bindingdb.org/rwd/tmp/petralfrolov_gmail.com4902.tsv) | [https://www.bindingdb.org/rwd/tmp/petralfrolov\_gmail.com4917.tsv](https://www.bindingdb.org/rwd/tmp/petralfrolov_gmail.com4917.tsv) |

*(у BindingDB прямые ссылки временные*)

### 2. Очистка и нормализация (`01_data_prep` ноут)

1. **Оставляем** только `Ki` и `IC50`.
2. Конвертируем всё в размерность **нМ.**
3. Затем **логарифмируем**: `pActivity = 9 – log10(nM)`.
4. **Канонизация** SMILES (SMILES -> RDKit.mol -> SMILES).
5. Для данных из **BDB** объединяем столбцы IC50 и Ki, предпочитая Ki, если данные есть для обоих столбцов.
6. Удаляем точные дубликаты; при нескольких различных измерениях для одной молекулы оставляем **медиану**.
7. Рассчитываем все доступные в RDKit молекулярные дескрипторы.

Результат:
*BACE1* — **22 689** строк, *AChE* — **14 171** строк.

---

## Обучение моделей для предсказания активности

Для отбора параметров – `RFECV` (Recursive feature elimination with CV). Этот метод неоднократно применялся нами в других задачах анализа данных и всегда оказывался наилучшим. Его минус - высокая ресурсозатратность, так как базовая модель обучается на множестве выборок с различными комбинациями параметров, и метод исключает или оставляет признаки в зависимости от их влияния на целевую метрику.

Итог - 81 столбец для BACE1 и 92 для AChE.

Мы воспользовались следующей архитектурой:

| Мишень | Модель                                | Важные гиперпараметры                          | MAE      | RMSE | R²   |   |
| ------ | ------------------------------------- | ---------------------------------------------- | -------- | ---- | ---- | - |
| BACE1  | Gradient Boosting Regressor (XGBoost) | `n_estimators=1000`, `eta=0.25`, `max_depth=7` | **0.52** | 0.71 | 0.71 |   |
| AChE   | Та же архитектура                     | Те же                                          | **0.53** | 0.74 | 0.78 |   |

После обучения:

1. Рассчитываем метрики на кросс-валидации с 5 фолдами.

   Имеем:
   | **Метрики на BACE1** | **Метрики на AchE**                                |
   | ------ | ------------------------------------- |
   | MAE: 0.5228  | MAE: 0.5300 |
   | RMSE: 0.7098   | RMSE: 0.7398                     |
   | R2: 0.7067   | R2: 0.7768                     |

2. Обучаем модели на всем объеме данных.

---

## Генерация и отбор молекул

### 1. DeepSeek‑LLM&#x20;

* 10 прогонов × 30-50 молекул → \~400 строк
* валидность SMILES ≈ 50-90 %
* SMILES однообразны и похожи друг на друга
* после фильтров осталась **1** молекула, прошедшая все критерии

### 2. REINVENT 4

* валидность SMILES ≈ 100 %
* **50 000** молекул → многошаговый фильтр:

| Фильтр           | Порог                                                  |
| ---------------- | ------------------------------------------------------ |
| Predicted pBACE1 | >5.0 (≤ 10 µM)                                         |
| Predicted pAChE  | > 5.0 (≤ 10 µM)                                        |
| QED              | > 0.6                                                  |
| SA Score         | < 6.0                                                  |
| **BBB / ADME**   | Clark‑logBB, TPSA < 90, HBD ≤ 3, MW ≤ 450, logD7.4 < 4 |
| **Токс‑стопы**   | PAINS=0; hERG‑alert=False; Brenk=0                     |
| **AD‑check**     | max Tanimoto ≥ 0.4 к train‑set                         |

> Итог — 51 хит, ***3 финальных хита*** для докинга.

---

## Докинг лучшей молекулы

* **Белки**:

  * AChE — 4EY7 (Donepezil)
  * BACE1 —1W51 (Beta Secretase)
* **Софты**: AutoDock‑Vina 1.2, rescoring Vinardo.
* **Лучший гибрид**
  *SMILES*: `Cc1ccc(CNC(=O)CN(c2ccc(C)cc2)S(=O)(=O)c2ccccc2)cc1`

  * ΔGAChE = ‑11.3 kcal/mol, ключевые H‑bond с Tyr337, Trp86
  * ΔGBACE1 = ‑10.6 kcal/mol, H‑bond Asp32/Asp228 + π‑stack Tyr71
  * MD 20 нс: RMSD lig \~ 1.8 Å, оккупируемость H‑bond Asp32 > 60 %.

---

## Ссылки и литература

* Patel *et al.*, 2022: роль BACE1 в патогенезе БА и обоснование его ингибирования.
* Patel *et al.*, 2022: перечисление ингибиторов BACE1, достигших поздних фаз клинических испытаний (верубецестат, и др.).
* RCSB PDB (2013): структура человеческой AChE в комплексе с донепезилом (иллюстрация наличия структурной информации по AChE).
* Yu *et al.*, 2023: современные препараты (ингибиторы холинэстераз, мемантин) лишь умеренно облегчают симптомы, не останавливая прогрессирование БА (ограничения AChE как мишени).
* DataCon‑25 TЗ — [https://github.com/AsyaOrlova/DataCon25](https://github.com/AsyaOrlova/DataCon25)
