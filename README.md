# DataCon‑2025 — команда **K1**

Ниже приведён итоговый README, описывающий весь пайплайн «end‑to‑end» для хакатона DataCon‑25 (TЗ → <https://github.com/AsyaOrlova/DataCon25>).  
Файл **DataCon.ipynb** содержит весь исполняемый код, а **DataCon.pptx** — краткие слайды‑выжимку.

---

## Содержание

1. [Выбор мишеней](#выбор-мишеней-для-разработки-лигандов)  
2. [Импорт и подготовка данных](#импорт-и-подготовка-данных)  
3. [Обучение моделей](#обучение-моделей-для-предсказания-активности)  
4. [Генерация / отбор молекул](#генерация-и-отбор-молекул)  
5. [Докинг и пост‑анализ](#докинг-лучшей-молекулы)  
6. [Структура репозитория / запуск](#структура-репозитория-и-базовый-запуск)  
7. [Ссылки и литература](#ссылки-и-литература)

---

## Выбор мишеней для разработки лигандов

| Мишень | Почему выбрана | Объём открытых данных | Структуры PDB |
|--------|---------------|-----------------------|---------------|
| **BACE1** (CHEMBL4822) | Лимитирующий шаг амилоидного каскада (β‑секретаза 1). Огромный набор ингибиторов → хороший сигнал для ML. | ≈ 22 000 Ki/IC₅₀ | > 70 (напр. 6UWP – flap‑open) |
| **AChE** (CHEMBL220) | Классическая симптоматическая мишень БА; даёт вторую «независимую» активность для концепции MTDL. | ≈ 14 000 Ki/IC₅₀ | > 60 (напр. 4EY7) |

> Стратегия — **MTDL** (multi‑target): одновременно увеличить когнитивный эффект (AChE) и модифицировать патологию (BACE1).

---

## Импорт и подготовка данных

### 1. Выгрузки

| Источник | AChE | BACE1 |
|----------|------|-------|
| **ChEMBL** | <https://www.ebi.ac.uk/chembl/explore/target/CHEMBL220> | <https://www.ebi.ac.uk/chembl/explore/target/CHEMBL4822> |
| **BindingDB** | TSV 4902 | TSV 4917 |

*(у BindingDB прямые ссылки одноразовые; реплицированы в `data/raw/`)*

### 2. Очистка и нормализация (`01_data_prep` ноут)

1. **Оставляем** только `Ki` и `IC50`, конвертируем всё в **нМ**, затем:  
   `pActivity = 9 – log10(nM)`.
2. **Канонизация** SMILES → InChIKey (`MolVS` + `RDKit`).
3. Удаляем точные дубликаты; при нескольких измерениях оставляем **медиану**, предпочитая `Ki`.
4. Разделяем на **train / valid / test** (Butina‑кластер‑split 80/10/10).

Результат:  
*BACE1* — **22 316** строк, *AChE* — **14 127** строк.

---

## Обучение моделей для предсказания активности

| Мишень | Модель | Важные гиперпараметры | MAE | RMSE | R² |
|--------|--------|-----------------------|-----|------|----|
| BACE1  | Gradient Boosting Regressor (XGBoost) + Morgan‑FP (2048 bt, rad = 2) | `n_estimators=1000`, `eta=0.03`, `max_depth=7` | **0.523** | 0.710 | 0.707 |
| AChE   | те же | | **0.530** | 0.740 | 0.777 |

*Feature‑selection* – `RFECV`, итог — 256 «бит» наиболее информативны.

Сериализованные модели лежат в `models/`.

---

## Генерация и отбор молекул

### 1. DeepSeek‑LLM (baseline)

* 3 прогона × 128 токенов → ~400 строк  
* валидность SMILES ≈ 90 %, дубликаты ≥ 40 %  
* после RDKit‑фильтра осталось **1** молекула, прошедшая ADMET‑критерии

### 2. REINVENT 4 + RL (production)

* fine‑tune на ChEMBL (1 эпоха)  
* reward = `0.5·pBACE1_pred + 0.5·pAChE_pred + QED – 0.2·SA`  
* 15 000 итераций PPO, batch = 128  
* валидность ≈ 100 %, новизна 92 %  
* **50 000** молекул → многошаговый фильтр:

| Фильтр | Порог |
|--------|-------|
| Predicted pBACE1 > **6.0** | (≤ 1 µM) |
| Predicted pAChE  > **5.0** | (≤ 10 µM) |
| QED > 0.6 | |
| SA < 6.0 | (RDKit SAscore) |
| **BBB / ADME** | Clark‑logBB, TPSA < 90, HBD ≤ 3, MW ≤ 450, logD7.4 < 4 |
| **Токс‑стопы** | PAINS=0; hERG‑alert=False; Brenk=0 |
| **AD‑check** | max Tanimoto ≥ 0.4 к train‑set |

> Итог — ***3 финальных хита*** (слайд 11 в `DataCon.pptx`).

---

## Докинг лучшей молекулы

* **Белки**:  
  * AChE — 4EY7 (донепезил‑комплекс)  
  * BACE1 — 6UWP (flap‑open)  
* **Софты**: AutoDock‑Vina 1.2, rescoring Vinardo.  
* **Лучший гибрид**  
  *SMILES*: `Cc1ccc(CNC(=O)CN(c2ccc(C)cc2)S(=O)(=O)c2ccccc2)cc1`  
  * ΔG<sub>AChE</sub> = ‑11.3 kcal/mol, ключевые H‑bond с Tyr337, Trp86  
  * ΔG<sub>BACE1</sub> = ‑10.6 kcal/mol, H‑bond Asp32/Asp228 + π‑stack Tyr71  
  * MD 20 нс: RMSD lig ~ 1.8 Å, оккупируемость H‑bond Asp32 > 60 %.

---

## Структура репозитория и базовый запуск

